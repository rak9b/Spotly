openapi: 3.0.0
info:
  title: LocalGuide.ai API
  description: Comprehensive API for LocalGuide platform including Events, Bookings, Wallet, and AI.
  version: 1.0.0
servers:
  - url: /api/v1
    description: Main API Server

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

security:
  - bearerAuth: []

paths:
  # --- Auth ---
  /auth/register:
    post:
      summary: Register a new user
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                email: { type: string }
                password: { type: string }
                role: { type: string, enum: [tourist, guide, host] }
      responses:
        '200':
          description: User registered
  
  /auth/login:
    post:
      summary: Login user
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                email: { type: string }
                password: { type: string }
      responses:
        '200':
          description: Login successful, returns tokens

  # --- Users & Profiles ---
  /users/me:
    get:
      summary: Get current user profile
      responses:
        '200':
          description: User profile data
    patch:
      summary: Update current user profile
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Profile'

  # --- Events ---
  /events:
    get:
      summary: List events
      parameters:
        - name: q
          in: query
          schema: { type: string }
        - name: city
          in: query
          schema: { type: string }
      responses:
        '200':
          description: List of events
    post:
      summary: Create event
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Event'
      responses:
        '201':
          description: Event created

  /events/{id}:
    get:
      summary: Get event details
    patch:
      summary: Update event
    delete:
      summary: Delete event

  # --- Bookings ---
  /bookings:
    post:
      summary: Create a booking
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                event_id: { type: string }
                seats: { type: integer }
      responses:
        '201':
          description: Booking created

  # --- Wallet ---
  /wallet:
    get:
      summary: Get wallet balance
      responses:
        '200':
          description: Wallet details
  
  /wallet/withdraw:
    post:
      summary: Request payout
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                amount_cents: { type: integer }

  # --- AI ---
  /ai/planner:
    post:
      summary: Generate trip plan
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                destination: { type: string }
                days: { type: integer }
      responses:
        '200':
          description: Generated itinerary

  /ai/chat:
    post:
      summary: Chat with AI assistant
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                message: { type: string }

components:
  schemas:
    Profile:
      type: object
      properties:
        fullName: { type: string }
        bio: { type: string }
        city: { type: string }
    Event:
      type: object
      properties:
        title: { type: string }
        price_cents: { type: integer }
        description: { type: string }
